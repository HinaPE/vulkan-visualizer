# Vulkan Visualizer 开发路线图（面向物理模拟可视化）

最后更新时间：2025-09-21

本路线图旨在把本项目发展为一个独立、通用、适配多类物理模拟数据的可视化器（Visualizer），保持引擎与具体渲染器解耦，不引入任何物理求解逻辑。

---

## 1. 当前能力概览

- 平台与依赖
  - Vulkan v1.4.321（动态渲染、Synchronization2、时间线信号量）。
  - SDL3（窗口与输入）、VkBootstrap（实例/设备/交换链）、VMA（显存分配）。
  - ImGui（Docking + 多视口）。
- 引擎职责
  - 设备/交换链生命周期、附件创建与管理、帧循环、同步、ImGui 集成。
  - 通过 `RendererCaps` 与渲染器协商：附件、呈现模式、是否启用 ImGui 等。
  - 呈现模式：EngineBlit / RendererComposite / DirectToSwapchain。
  - 可选异步计算（独立队列与命令缓冲）。
- 示例
  - `examples/basic_window`：最小三角形绘制，演示离屏渲染 + 引擎 Blit。

---

## 2. 原则

- 仅建设可视化所需通用能力（相机、上传、着色器热更、截图、统计、UI）。
- 引擎提供“服务”，渲染器依赖服务完成具体渲染逻辑。
- 保持模块化与可扩展，避免硬耦合。

---

## 3. 里程碑

### M0 基础打牢
- 日志与错误处理；HUD 日志窗口。
- CMake 选项化特性开关（ImGui/Async Compute 等）。
- GPU 时间戳查询与 HUD 展示。
- 文件监视与着色器热更（GLSL→SPIR-V）。
- 截图（PNG，交换链或离屏附件）。
- 可选 Tone Mapping 与 sRGB 显示。

验收：示例含 HUD 计时、日志；支持热更；一键截图；Tone Mapping 开关有效。

### M1 数据接入与场景基础
- Engine Services（通过 `EngineContext.services` 暴露）：
  - UploadContext、ShaderManager、TimestampQueryService、ScreenshotService（PNG）、FileWatcher、DebugDraw。
- 数据输入：简单文件格式（JSON+二进制块）与目录监听。
- 相机控制（轨道/飞行）、坐标轴/网格（基础）。
- 基础图元：点云、线段/折线、三角网格；流式上传与实例化。

验收：示例展示多图元与连续帧文件加载；百万级点云可交互。

### M2 科学可视化增强
- 色标/传递函数系统与色标条。
- 向量/张量 glyph（箭头、椭球/盒）。
- 裁剪/切片；透明度与 OIT（WBOIT）。
- 屏幕文字与标注。

### M3 交互、选择与测量
- 拾取（点/三角形）、选择集管理与属性查看。
- 测量工具（距离/角度）；相机对齐与正交视图。
- 时间轴与播放控制（步进/循环/速度）。

### M4 I/O 与自动化
- 更多导入器（PLY/OBJ/GLB/CSV 子集/VTK 子集）。
- 会话保存/加载；命令行参数；无头渲染。
- 高分辨率离屏渲染（超采样/分块）、PNG 序列；（可选）外部 ffmpeg 管道。

### M5 性能与稳定性
- 视锥剔除、实例化批渲染；分块/分页大数据。
- 压力测试与回归基准；显存预算阈值提示。

### M6 扩展性与易用性
- 插件/脚本（Lua/Python）驱动相机/时间轴/截图。
- UI 主题与布局预设；统一设置面板。
- 文档与示例完善。

---

## 4. 模块设计（最小侵入）
- EngineServices：Upload/Shader/Query/Screenshot（PNG）/FileWatcher/DebugDraw。
- 渲染通道与附件协商保留；后续拓展 MSAA 与 OIT 附件。
- 统一图元库（点/线/网）：统一顶点/实例布局与着色路径。
- 交互：相机库可复用；拾取首版使用 ID Pass 回读。
- I/O 与会话：简易二进制帧格式；会话 JSON。

---

## 5. 风险与取舍
- 透明度排序成本与近似 OIT 取舍。
- 体渲染推后（先做切片）。
- 多平台差异（后续验证 Linux）。

---

## 6. 示例与测试
- 示例：点云+折线+网格、裁剪、色标、时间轴+截图序列。
- 自动化：无头渲染 N 帧并哈希比对；不同规模点云基准；热更稳定性测试。

---

## 7. 排期（粗略）
- M0：1–2 周；M1：3–4 周；M2：4–6 周；M3：2–3 周；M4：3–5 周；M5：持续；M6：1–2 周。

---

## 8. 近期改动（最小集合）
- 精简截图为 PNG，移除 OpenEXR/TinyEXR 相关依赖与实现。
- 保持引擎接口稳定；HUD 与时间戳展示增强。
- 示例与文档同步更新。

---

如需我基于此路线图先落地 M0/M1 的骨架代码与示例，请告知优先级与目标平台/数据规模，我会直接在仓库中搭建对应模块与演示。
